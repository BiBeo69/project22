<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI-TECH MEDICAL LAB – Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --card: #0b1120;
      --accent: #38bdf8;
      --text: #f9fafb;
      --muted: #9ca3af;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0b1120, #020617);
      color: var(--text);
      min-height: 100vh;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
    }

    .logo-link {
      font-size: 14px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      text-decoration: none;
      color: var(--muted);
    }

    .logo-link span {
      color: var(--accent);
      font-weight: 600;
    }

    .back-link {
      font-size: 12px;
      text-decoration: none;
      color: var(--accent);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 4px 10px;
    }

    .back-link:hover {
      background: rgba(15, 23, 42, 0.85);
    }

    .hero-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      font-size: 11px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--muted);
      margin-bottom: 10px;
    }

    .hero-pill span {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }

    .hero-title {
      font-size: clamp(24px, 4vw, 32px);
      margin-bottom: 8px;
    }

    .hero-subtitle {
      font-size: 14px;
      color: var(--muted);
      max-width: 640px;
      line-height: 1.45;
    }

    .hero-note {
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
    }

    .hero-note strong {
      color: #f97316;
      font-weight: 500;
    }

    .tool-layout {
      margin-top: 28px;
      display: grid;
      grid-template-columns: minmax(0, 6fr) minmax(0, 4fr);
      gap: 24px;
      align-items: flex-start;
    }

    @media (max-width: 820px) {
      .tool-layout {
        grid-template-columns: 1fr;
      }
    }

    .tool-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 18px;
      border: 1px solid rgba(75, 85, 99, 0.7);
      padding: 20px 18px 22px;
      backdrop-filter: blur(18px);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.7);
    }

    .tool-card h2 {
      font-size: 18px;
      margin-bottom: 6px;
    }

    .tool-card p {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 14px;
    }

    .field {
      flex: 1 1 160px;
      margin-bottom: 10px;
    }

    .field label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .field input,
    .field select,
    .field textarea {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: #020617;
      color: var(--text);
      font-size: 14px;
      resize: vertical;
      min-height: 40px;
    }

    button.btn {
      margin-top: 6px;
      padding: 9px 16px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #38bdf8, #0ea5e9);
      color: white;
      font-weight: 500;
      cursor: pointer;
      font-size: 14px;
    }

    button.btn:hover {
      filter: brightness(1.08);
    }

    .result {
      margin-top: 16px;
      font-size: 14px;
      white-space: pre-wrap;
    }

    .warn {
      color: #f97316;
    }

    .side-panel {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    /* Ảnh oblong, cùng tỷ lệ */
    .image-frame {
      position: relative;
      width: 100%;
      max-width: 100%;
      aspect-ratio: 16 / 9; /* khung ngang */
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: radial-gradient(circle at top, #020617, #000);
    }

    .image-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    .image-frame img.fade-out {
      opacity: 0;
    }

    .side-caption {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.5;
    }

    footer {
      margin-top: 40px;
      font-size: 12px;
      color: var(--muted);
      text-align: center;
      padding-bottom: 12px;
      line-height: 1.5;
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    .tool-panel {
      display: none;
    }

    .not-found {
      text-align: center;
      margin-top: 60px;
    }

    .not-found h2 {
      font-size: 22px;
      margin-bottom: 8px;
    }

    .not-found p {
      color: var(--muted);
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="top-bar">
      <a href="index.html" class="logo-link"><span>AI-TECH</span> MEDICAL LAB</a>
      <a href="index.html" class="back-link">← Back to all Doctor Cal modules</a>
    </header>

    <!-- ============ BMI PANEL ============ -->
    <section id="tool-bmi" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – BMI & lifestyle</div>
      </div>
      <h1 class="hero-title">BMI and lifestyle discussion</h1>
      <p class="hero-subtitle">
        Enter your height and weight and Doctor Cal will estimate your BMI and explain what it roughly means,
        using simple language and a few everyday lifestyle ideas.
      </p>
      <p class="hero-note">
        <strong>Important:</strong> This is only for learning and self-reflection, not real medical advice.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Talk to Doctor Cal</h2>
          <p>Fill in your numbers and Doctor Cal will answer like a friendly doctor speaking in plain English.</p>

          <form id="bmi-form">
            <div class="form-row">
              <div class="field">
                <label for="bmi-weight">Weight (kg)</label>
                <input type="number" id="bmi-weight" min="1" step="0.1" required />
              </div>
              <div class="field">
                <label for="bmi-height">Height (cm)</label>
                <input type="number" id="bmi-height" min="50" step="0.5" required />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label for="bmi-sex">Sex (optional)</label>
                <select id="bmi-sex">
                  <option value="">Not specified</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
              </div>
            </div>
            <button class="btn" type="submit">Ask Doctor Cal to analyze BMI</button>
          </form>

          <div id="bmi-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="bmi1.png,bmi2.png,bmi3.png">
            <img src="images/bmi1.png" alt="BMI demo illustration" />
          </div>
          <p class="side-caption">
            BMI (body mass index) is a simple ratio of weight and height that gives a rough idea of body size
            at the population level. It can hint at underweight, normal weight, overweight or obesity, but it does not
            see muscle mass, body shape or fitness. It is only one small piece of the health picture and can never
            replace a full check-up with a real doctor.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ CHROMOSOME PANEL ============ -->
    <section id="tool-chromosome" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Cytogenetics demo</div>
      </div>
      <h1 class="hero-title">Chromosome classifier</h1>
      <p class="hero-subtitle">
        Upload a karyotype or chromosome spread image. Doctor Cal will give a gentle, high-level comment
        about whether it looks more like a normal pattern or a possible abnormal one.
      </p>
      <p class="hero-note">
        <strong>Warning:</strong> This is not a real genetic test and must not be used to diagnose any condition.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Upload chromosome image</h2>
          <p>If the picture is not really a chromosome image, Doctor Cal will kindly ask you to try another one.</p>

          <form id="chromosome-form">
            <div class="field">
              <label for="chromosome-image">Chromosome / karyotype image (JPG/PNG)</label>
              <input type="file" id="chromosome-image" accept="image/*" required />
            </div>
            <button class="btn" type="submit">Ask Doctor Cal (vision)</button>
          </form>

          <div id="chromosome-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="chromosome1.png,chromosome2.png,chromosome3.png">
            <img src="images/chromosome1.png" alt="Chromosome demo slide" />
          </div>
          <p class="side-caption">
            Human cells usually have 46 chromosomes arranged in 23 pairs. A karyotype is a lab picture where these
            chromosomes are lined up so extra or missing copies can be seen. When there is an extra copy of a chromosome,
            such as chromosome 21 in Down syndrome, it can affect growth and development. True diagnosis always needs
            proper laboratory tests and specialist review, not this demo.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ CANCER CELL PANEL ============ -->
    <section id="tool-cancer" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Pathology demo</div>
      </div>
      <h1 class="hero-title">Cancer cell classifier</h1>
      <p class="hero-subtitle">
        Upload a microscopic image of cells. Doctor Cal will talk in simple English about whether the cells look
        more calm, a bit suspicious or very worrying, purely for training.
      </p>
      <p class="hero-note">
        <strong>Warning:</strong> This does not diagnose cancer and cannot replace a real pathologist.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Upload microscopy image</h2>
          <p>If the picture is not a microscope slide, Doctor Cal will ask you to try another image.</p>

          <form id="cancer-form">
            <div class="field">
              <label for="cancer-image">Microscopy / cytology image (JPG/PNG)</label>
              <input type="file" id="cancer-image" accept="image/*" required />
            </div>
            <button class="btn" type="submit">Ask Doctor Cal (vision)</button>
          </form>

          <div id="cancer-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="cancer1.png,cancer2.png,cancer3.png">
            <img src="images/cancer1.png" alt="Cancer cell demo slide" />
          </div>
          <p class="side-caption">
            Under the microscope, benign cells usually keep a regular shape, clear borders and an orderly pattern.
            Cancer cells often show bigger, darker nuclei, strange shapes and a more chaotic arrangement. These changes
            help pathologists decide whether something is likely harmless or worrying. However, only real lab tests
            and expert review can make or exclude a cancer diagnosis.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ XRAY PANEL ============ -->
    <section id="tool-xray" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Chest imaging demo</div>
      </div>
      <h1 class="hero-title">Chest X-ray interpretation</h1>
      <p class="hero-subtitle">
        Upload a chest X-ray. Doctor Cal will use very simple words to describe what may be visible and whether
        something might look unusual, as a teaching example.
      </p>
      <p class="hero-note">
        <strong>Warning:</strong> This is not a radiology report. Real X-rays must be read by qualified doctors.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Upload chest X-ray</h2>
          <p>Use a clear chest X-ray if you can. Blurry or non-X-ray pictures will be flagged by Doctor Cal.</p>

          <form id="xray-form">
            <div class="field">
              <label for="xray-image">Chest X-ray image (JPG/PNG)</label>
              <input type="file" id="xray-image" accept="image/*" required />
            </div>
            <button class="btn" type="submit">Ask Doctor Cal (vision)</button>
          </form>

          <div id="xray-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="xray1.png,xray2.png,xray3.png">
            <img src="images/xray1.png" alt="Chest X-ray demo" />
          </div>
          <p class="side-caption">
            A chest X-ray shows the lungs, heart shadow, ribs and diaphragm in a single picture. Doctors look at the
            shape of the heart, the clarity of the lung fields and any bright or dark spots that might suggest fluid,
            infection or other problems. This demo only gives a rough description and can never replace a formal
            radiology report.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ DOSE X PANEL ============ -->
    <section id="tool-dosex" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Pharmacology demo</div>
      </div>
      <h1 class="hero-title">Fictional Drug X dosing</h1>
      <p class="hero-subtitle">
        Use this demo to explore how age, body weight and kidney function might change the way doctors think
        about dosing a medicine, using a completely fictional drug called Drug X.
      </p>
      <p class="hero-note">
        <strong>Important:</strong> Drug X is imaginary. Nothing here should ever be used for real medications.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Provide scenario for Drug X</h2>
          <p>Doctor Cal will explain the general idea behind dose changes without naming real drugs or real doses.</p>

          <form id="dose-form">
            <div class="form-row">
              <div class="field">
                <label for="dose-weight">Weight (kg)</label>
                <input type="number" id="dose-weight" min="1" step="0.1" required />
              </div>
              <div class="field">
                <label for="dose-age">Age (years)</label>
                <input type="number" id="dose-age" min="0" step="1" required />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label for="dose-egfr">Estimated kidney function (eGFR, mL/min, optional)</label>
                <input type="number" id="dose-egfr" min="0" step="1" />
              </div>
            </div>
            <button class="btn" type="submit">Ask Doctor Cal about Drug X</button>
          </form>

          <div id="dose-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="dosex1.png,dosex2.png,dosex3.png">
            <img src="images/dosex1.png" alt="Drug X demo" />
          </div>
          <p class="side-caption">
            Many real medicines are handled by the liver and kidneys. In older people or in people with lower kidney
            function, the body may clear drugs more slowly, so doctors often think about using smaller or less frequent
            doses. Drug X in this lab is only a teaching example to explore that idea, not a real treatment plan.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ CARDIAC PANEL ============ -->
    <section id="tool-cardiac" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Cardiovascular demo</div>
      </div>
      <h1 class="hero-title">Cardiovascular risk discussion</h1>
      <p class="hero-subtitle">
        Enter a few basic factors, such as age, blood pressure and smoking, and Doctor Cal will talk about whether
        your long-term heart risk sounds lower or higher in simple terms.
      </p>
      <p class="hero-note">
        <strong>Note:</strong> This is not a formal risk score and should never guide real treatment decisions.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Enter risk factors</h2>
          <p>Doctor Cal will respond as if talking to you in a clinic, but in a very general and educational way.</p>

          <form id="cardiac-form">
            <div class="form-row">
              <div class="field">
                <label for="cardiac-age">Age (years)</label>
                <input type="number" id="cardiac-age" min="18" max="100" step="1" required />
              </div>
              <div class="field">
                <label for="cardiac-sex">Sex</label>
                <select id="cardiac-sex">
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                </select>
              </div>
              <div class="field">
                <label for="cardiac-sbp">Systolic blood pressure (mmHg)</label>
                <input type="number" id="cardiac-sbp" min="80" max="260" step="1" required />
              </div>
            </div>

            <div class="form-row">
              <div class="field">
                <label for="cardiac-smoker">Smoker?</label>
                <select id="cardiac-smoker">
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
              <div class="field">
                <label for="cardiac-diabetes">Diabetes?</label>
                <select id="cardiac-diabetes">
                  <option value="no">No</option>
                  <option value="yes">Yes</option>
                </select>
              </div>
              <div class="field">
                <label for="cardiac-chol">Total cholesterol (mmol/L, optional)</label>
                <input type="number" id="cardiac-chol" min="2" max="10" step="0.1" />
              </div>
            </div>

            <button class="btn" type="submit">Ask Doctor Cal about heart risk</button>
          </form>

          <div id="cardiac-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="cardiac1.png,cardiac2.png,cardiac3.png">
            <img src="images/cardiac1.png" alt="Heart risk demo" />
          </div>
          <p class="side-caption">
            Over many years, risk factors such as age, high blood pressure, smoking, diabetes and high cholesterol
            can damage blood vessels and make heart attacks or strokes more likely. Lifestyle changes like stopping
            smoking, moving more and improving diet can lower this risk. This lab is only a gentle guide to the ideas,
            not a substitute for seeing a real doctor.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ LAB PANEL ============ -->
    <section id="tool-lab" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – Hematology demo</div>
      </div>
      <h1 class="hero-title">Complete blood count interpretation</h1>
      <p class="hero-subtitle">
        Enter hemoglobin, white blood cells and platelets. Doctor Cal will explain in simple words whether they
        look low, normal or high compared with typical adult ranges.
      </p>
      <p class="hero-note">
        <strong>Warning:</strong> Real lab results always need a doctor who knows the full clinical story.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Enter CBC values</h2>
          <p>Try different numbers and see how Doctor Cal reacts in an educational way.</p>

          <form id="lab-form">
            <div class="form-row">
              <div class="field">
                <label for="lab-hb">Hemoglobin (g/dL)</label>
                <input type="number" id="lab-hb" min="5" max="25" step="0.1" required />
              </div>
              <div class="field">
                <label for="lab-wbc">White blood cells (10^9/L)</label>
                <input type="number" id="lab-wbc" min="1" max="50" step="0.1" required />
              </div>
              <div class="field">
                <label for="lab-plt">Platelets (10^9/L)</label>
                <input type="number" id="lab-plt" min="20" max="1000" step="1" required />
              </div>
            </div>

            <button class="btn" type="submit">Ask Doctor Cal to interpret</button>
          </form>

          <div id="lab-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="lab1.png,lab2.png,lab3.png">
            <img src="images/lab1.png" alt="Lab demo image" />
          </div>
          <p class="side-caption">
            A complete blood count looks at red cells (which carry oxygen), white cells (which fight infection)
            and platelets (which help blood clot). Low or high values can be linked to many different situations,
            from simple infections to more serious diseases. This demo can only give a rough, educational explanation,
            never a firm diagnosis.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ Q&A PANEL ============ -->
    <section id="tool-qa" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>Doctor Cal – General Q&amp;A</div>
      </div>
      <h1 class="hero-title">Ask Doctor Cal anything</h1>
      <p class="hero-subtitle">
        Type a question about symptoms, diseases, tests or treatments. Doctor Cal will answer in warm, simple English
        to help you understand the topic better.
      </p>
      <p class="hero-note">
        <strong>Reminder:</strong> This is only general information. For personal health questions, please see a real doctor.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Your question for Doctor Cal</h2>
          <p>Write naturally, as if you are talking to a doctor. Doctor Cal will reply in a similar tone.</p>

          <form id="qa-form">
            <div class="field">
              <label for="qa-question">Question</label>
              <textarea id="qa-question" rows="4" placeholder="Example: Could you explain what liver enzymes mean and why they might be elevated?"></textarea>
            </div>
            <button class="btn" type="submit">Ask Doctor Cal</button>
          </form>

          <div id="qa-result" class="result"></div>
        </div>

        <aside class="side-panel">
          <div class="image-frame" data-images="doctorcal1.png,doctorcal2.png,doctorcal3.png">
            <img src="images/doctorcal1.png" alt="Doctor Cal illustration" />
          </div>
          <p class="side-caption">
            Doctor Cal is a virtual medical assistant designed to explain medical ideas in everyday language.
            It can help you learn and prepare better questions for your own doctor, but it cannot examine you,
            order tests or replace real medical care.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ INFORMATION PANEL ============ -->
    <section id="tool-info" class="tool-panel">
      <div class="hero-pill">
        <span></span>
        <div>AI-TECH MEDICAL LAB – Information</div>
      </div>
      <h1 class="hero-title">About the creator and this lab</h1>
      <p class="hero-subtitle">
        This page explains who created AI-TECH MEDICAL LAB and why it exists. It is a small personal project that
        combines a love of medicine and modern AI technology.
      </p>
      <p class="hero-note">
        <strong>Reminder:</strong> The whole website is for education and experimentation only, not real medical care.
      </p>

      <div class="tool-layout">
        <div class="tool-card">
          <h2>Who is behind AI-TECH MEDICAL LAB?</h2>
          <p>
            My name is <strong>Pham Minh Son</strong>. I am a grade 12 Informatics student at
            <strong>Hanoi – Amsterdam High School for the Gifted</strong>.
          </p>
          <p>
            I built this website using HTML, JavaScript and a simple backend that connects to modern AI models.
            The idea is to create a small “lab” where people can play with medical concepts, upload images and see
            how an AI assistant like <strong>Doctor Cal</strong> explains things in simple English.
          </p>
          <p>
            Medicine has been a long-time passion for me. At the same time, I enjoy programming and exploring
            cutting-edge AI. This project is my way of bringing those two interests together: using AI to
            experiment with medical topics in a safe, clearly educational environment.
          </p>
          <p>
            Every tool in this lab is <strong>for learning only</strong>. Nothing here is a real diagnosis,
            treatment recommendation or medical device. The goal is to help people understand ideas a bit better,
            and maybe inspire more students to explore both medicine and technology.
          </p>
          <p>
            If you would like to contact me about this project, share feedback or discuss ideas, you can email:
            <strong><a href="mailto:phamminhson08@gmail.com">phamminhson08@gmail.com</a></strong>.
          </p>
          <p>
            Thank you for visiting AI-TECH MEDICAL LAB and spending time with Doctor Cal.
          </p>
        </div>

        <aside class="side-panel">
          <div class="image-frame">
            <!-- Bạn có thể đặt ảnh giới thiệu ở đây, ví dụ: images/info1.png -->
            <img src="images/info1.png" alt="AI-TECH MEDICAL LAB information" />
          </div>
          <p class="side-caption">
            AI-TECH MEDICAL LAB is a personal experimental site created by a high school student.
            It shows how modern AI can be used to explain medical ideas, but it never replaces real doctors,
            real hospitals or official medical tools.
          </p>
        </aside>
      </div>
    </section>

    <!-- ============ NOT FOUND PANEL ============ -->
    <section id="tool-not-found" class="tool-panel not-found">
      <h2>Module not found</h2>
      <p>
        The requested Doctor Cal module could not be found. Please go back to the
        <a href="index.html" style="color: var(--accent);">AI-TECH MEDICAL LAB home page</a>
        and choose a tool from the grid.
      </p>
    </section>

    <footer>
      © 2025 AI-TECH MEDICAL LAB • Experimental educational project by
      <strong>Pham Minh Son</strong>
      (<a href="mailto:phamminhson08@gmail.com">phamminhson08@gmail.com</a>).<br />
      Doctor Cal is a virtual medical assistant for learning and experimentation only, with no real medical or diagnostic value.
    </footer>
  </div>

  <script>
    const API_BASE = "https://ai-medical-8tex.onrender.com";

    // --------- Tool routing ----------
    function getToolFromQuery() {
      const params = new URLSearchParams(window.location.search);
      return (params.get("tool") || "").toLowerCase();
    }

    function activateToolPanel(tool) {
      const allPanels = document.querySelectorAll(".tool-panel");
      allPanels.forEach(p => p.style.display = "none");

      const id = tool ? "tool-" + tool : "tool-not-found";
      const active = document.getElementById(id) || document.getElementById("tool-not-found");
      active.style.display = "block";
    }

    const currentTool = getToolFromQuery();
    activateToolPanel(currentTool);

    // --------- Helper functions ----------
    function showError(targetEl, message) {
      if (!targetEl) return;
      targetEl.textContent = message;
    }

    function showText(targetEl, text) {
      if (!targetEl) return;
      targetEl.textContent = text;
    }

    // --------- Image slideshows ----------
    function initSlideshows() {
      const frames = document.querySelectorAll(".image-frame[data-images]");
      frames.forEach(frame => {
        const img = frame.querySelector("img");
        if (!img) return;

        const listRaw = frame.dataset.images || "";
        const files = listRaw.split(",").map(s => s.trim()).filter(Boolean);
        if (files.length <= 1) return;

        let index = 0;

        setInterval(() => {
          index = (index + 1) % files.length;
          img.classList.add("fade-out");
          setTimeout(() => {
            img.src = "images/" + files[index];
            img.classList.remove("fade-out");
          }, 400);
        }, 5000);
      });
    }

    initSlideshows();

    // --------- BMI ----------
    const bmiForm = document.getElementById("bmi-form");
    const bmiResult = document.getElementById("bmi-result");
    if (bmiForm && bmiResult) {
      bmiForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const weight = parseFloat(document.getElementById("bmi-weight").value);
        const heightCm = parseFloat(document.getElementById("bmi-height").value);
        const sex = document.getElementById("bmi-sex").value || null;

        if (isNaN(weight) || isNaN(heightCm)) {
          showError(bmiResult, "Please enter valid numbers for weight and height.");
          return;
        }

        showText(bmiResult, "Asking Doctor Cal to analyze your BMI...");

        try {
          const res = await fetch(API_BASE + "/api/bmi-analysis", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ weight, height_cm: heightCm, sex }),
          });
          const data = await res.json();
          if (!res.ok) {
            showError(bmiResult, data.error || "Server error.");
            return;
          }
          showText(bmiResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(bmiResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Chromosome (vision) ----------
    const chromosomeForm = document.getElementById("chromosome-form");
    const chromosomeResult = document.getElementById("chromosome-result");
    if (chromosomeForm && chromosomeResult) {
      chromosomeForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const fileInput = document.getElementById("chromosome-image");
        if (!fileInput.files[0]) {
          showError(chromosomeResult, "Please choose an image first.");
          return;
        }

        const formData = new FormData();
        formData.append("image", fileInput.files[0]);

        showText(chromosomeResult, "Sending your chromosome image to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/chromosome", {
            method: "POST",
            body: formData,
          });
          const data = await res.json();
          if (!res.ok) {
            showError(chromosomeResult, data.error || "Server error.");
            return;
          }
          showText(chromosomeResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(chromosomeResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Cancer (vision) ----------
    const cancerForm = document.getElementById("cancer-form");
    const cancerResult = document.getElementById("cancer-result");
    if (cancerForm && cancerResult) {
      cancerForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const fileInput = document.getElementById("cancer-image");
        if (!fileInput.files[0]) {
          showError(cancerResult, "Please choose an image first.");
          return;
        }

        const formData = new FormData();
        formData.append("image", fileInput.files[0]);

        showText(cancerResult, "Sending your cell image to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/cancer-cell", {
            method: "POST",
            body: formData,
          });
          const data = await res.json();
          if (!res.ok) {
            showError(cancerResult, data.error || "Server error.");
            return;
          }
          showText(cancerResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(cancerResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- X-ray (vision) ----------
    const xrayForm = document.getElementById("xray-form");
    const xrayResult = document.getElementById("xray-result");
    if (xrayForm && xrayResult) {
      xrayForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const fileInput = document.getElementById("xray-image");
        if (!fileInput.files[0]) {
          showError(xrayResult, "Please choose a chest X-ray image first.");
          return;
        }

        const formData = new FormData();
        formData.append("image", fileInput.files[0]);

        showText(xrayResult, "Sending your chest X-ray to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/chest-xray", {
            method: "POST",
            body: formData,
          });
          const data = await res.json();
          if (!res.ok) {
            showError(xrayResult, data.error || "Server error.");
            return;
          }
          showText(xrayResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(xrayResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Dose X (text) ----------
    const doseForm = document.getElementById("dose-form");
    const doseResult = document.getElementById("dose-result");
    if (doseForm && doseResult) {
      doseForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const weight = parseFloat(document.getElementById("dose-weight").value);
        const age = parseFloat(document.getElementById("dose-age").value);
        const egfrRaw = document.getElementById("dose-egfr").value;
        const egfr = egfrRaw ? parseFloat(egfrRaw) : null;

        if (isNaN(weight) || isNaN(age)) {
          showError(doseResult, "Please enter valid weight and age.");
          return;
        }

        showText(doseResult, "Sending your parameters to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/dose-x", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ weight, age, egfr }),
          });
          const data = await res.json();
          if (!res.ok) {
            showError(doseResult, data.error || "Server error.");
            return;
          }
          showText(doseResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(doseResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Cardiac risk (text) ----------
    const cardiacForm = document.getElementById("cardiac-form");
    const cardiacResult = document.getElementById("cardiac-result");
    if (cardiacForm && cardiacResult) {
      cardiacForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const age = parseFloat(document.getElementById("cardiac-age").value);
        const sex = document.getElementById("cardiac-sex").value;
        const sbp = parseFloat(document.getElementById("cardiac-sbp").value);
        const smoker = document.getElementById("cardiac-smoker").value;
        const diabetes = document.getElementById("cardiac-diabetes").value;
        const cholRaw = document.getElementById("cardiac-chol").value;
        const chol = cholRaw ? parseFloat(cholRaw) : null;

        if (isNaN(age) || isNaN(sbp)) {
          showError(cardiacResult, "Please enter valid age and systolic blood pressure.");
          return;
        }

        showText(cardiacResult, "Sending your risk factors to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/cardiac-risk", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ age, sex, sbp, smoker, diabetes, chol }),
          });
          const data = await res.json();
          if (!res.ok) {
            showError(cardiacResult, data.error || "Server error.");
            return;
          }
          showText(cardiacResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(cardiacResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Lab blood (text) ----------
    const labForm = document.getElementById("lab-form");
    const labResult = document.getElementById("lab-result");
    if (labForm && labResult) {
      labForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const hb = parseFloat(document.getElementById("lab-hb").value);
        const wbc = parseFloat(document.getElementById("lab-wbc").value);
        const plt = parseFloat(document.getElementById("lab-plt").value);

        if (isNaN(hb) || isNaN(wbc) || isNaN(plt)) {
          showError(labResult, "Please enter valid numbers for Hb, WBC and PLT.");
          return;
        }

        showText(labResult, "Sending your lab values to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/lab-blood", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ hb, wbc, plt }),
          });
          const data = await res.json();
          if (!res.ok) {
            showError(labResult, data.error || "Server error.");
            return;
          }
          showText(labResult, data.analysis || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(labResult, "Could not reach the backend. Is the server running?");
        }
      });
    }

    // --------- Doctor Cal Q&A (text) ----------
    const qaForm = document.getElementById("qa-form");
    const qaResult = document.getElementById("qa-result");
    if (qaForm && qaResult) {
      qaForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const q = document.getElementById("qa-question").value.trim();
        if (!q) {
          showError(qaResult, "Please type a question first.");
          return;
        }

        showText(qaResult, "Sending your question to Doctor Cal...");

        try {
          const res = await fetch(API_BASE + "/api/doctor-chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ question: q }),
          });
          const data = await res.json();
          if (!res.ok) {
            showError(qaResult, data.error || "Server error.");
            return;
          }
          showText(qaResult, data.answer || "No response from the system.");
        } catch (err) {
          console.error(err);
          showError(qaResult, "Could not reach the backend. Is the server running?");
        }
      });
    }
  </script>
</body>
</html>
